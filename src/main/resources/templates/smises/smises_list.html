<!DOCTYPE html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">
<head>

    <title th:text="#{navMenu.home}"/>


    <th:block th:include="fragments/headerinc :: head"></th:block>
    <th:block th:include="fragments/header :: header"></th:block>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    <style>
        .treeCSS,
        .treeCSS ul {
            position: relative;
            display: table;
            margin: 5px 0 0 0 !important;
            padding: 6px 0 0 0 !important;
            line-height: normal;
            text-align: center;
            word-wrap: break-word;
            word-break: break-all;
        }
        .treeCSS li {
            position: relative;
            display: table-cell;
        }
        /* Отступ между пунктами */
        .treeCSS li:not(:only-child) {
            padding: 0 .5em;
        }
        .treeCSS li:last-child {
            padding-right: 0;
        }
        .treeCSS li:first-child {
            padding-left: 0;
        }
        /* Линии */
        .treeCSS ul:before,
        .treeCSS ul li:before,
        .treeCSS ul li:after {
            content: "";
            position: absolute;
            top: -5px;
            left: 0;
            width: 50%;
            height: 5px;
            border-right: 1px solid #999;
        }
        .treeCSS ul:before {
            top: -4px;
        }
        .treeCSS ul li:not(:only-child):before {
            border-top: 1px solid #999;
        }
        .treeCSS ul li:not(:only-child):first-child:before {
            right: 0;
            left: auto;
            border-left: 1px solid #999;
            border-right: none;
        }
        .treeCSS ul li:not(:only-child):first-child:before,
        .treeCSS ul li:not(:only-child):last-child:before { /* необязательно, 0.5 взят из свойства padding в селекторе .treeCSS li:not(:only-child) */
            width: calc(50% + .5em/2);
        }
        .treeCSS ul li:after {
            border: none;
        }
        .treeCSS ul li:not(:last-child):not(:first-child):after {
            width: 100%;
            border-top: 1px solid #999;
        }
    </style>
<script type="text/javascript" th:inline="javascript">
    var listCategories = {
        data: [

            {
                itemId: 1,
                itemName: "пункт №1",
                itemParentId: 0
            },

            {
                itemId: 2,
                itemName: "пункт №1.1",
                itemParentId: 1
            },

            {
                itemId: 3,
                itemName: "пункт №1.2",
                itemParentId: 1
            },

            {
                itemId: 4,
                itemName: "пункт №1.2.1",
                itemParentId: 3
            },

            {
                itemId: 5,
                itemName: "пункт №1.2.2",
                itemParentId: 3
            },

            {
                itemId: 6,
                itemName: "пункт №1.2.3",
                itemParentId: 3
            },

            {
                itemId: 7,
                itemName: "пункт №2",
                itemParentId: 0
            },

            {
                itemId: 8,
                itemName: "пункт №3",
                itemParentId: 0
            },

            {
                itemId: 9,
                itemName: "пункт №3.1",
                itemParentId: 8
            },

            {
                itemId: 10,
                itemName: "пункт №3.2",
                itemParentId: 8
            },

            {
                itemId: 11,
                itemName: "пункт №3.3",
                itemParentId: 8
            },

            {
                itemId: 12,
                itemName: "пункт №3.3.1",
                itemParentId: 11
            },

            {
                itemId: 13,
                itemName: "пункт №3.3.1.1",
                itemParentId: 12
            },

            {
                itemId: 14,
                itemName: "пункт №3.3.1.2",
                itemParentId: 12
            },

            {
                itemId: 15,
                itemName: "пункт №3.3.1.3",
                itemParentId: 12
            },

            {
                itemId: 16,
                itemName: "пункт №3.3.2",
                itemParentId: 11
            },

            {
                itemId: 17,
                itemName: "пункт №4",
                itemParentId: 0
            },

            {
                itemId: 18,
                itemName: "пункт №5",
                itemParentId: 0
            },

            {
                itemId: 19,
                itemName: "пункт №5.1",
                itemParentId: 18
            }

        ]
    };

    function createTree(data, parentId) {

        parentId = parentId || 0;
        var items = data.filter(function(el) {
            return el.itemParentId == parentId;
        });

        if (items.length == 0) return null;

        var tree = $('<ul>').addClass('treeCSS');
        tree.append(
            items.map(
                function(el) {
                    var li = $('<li>').append(
                        $('<a>').addClass('state')
                        ).append(
                        $('<a>').html(el.itemName).attr('id', el.itemId).addClass('item')
                        ),
                        nestedTree = createTree(data, el.itemId);

                    if (nestedTree !== null) {
                        li.append(nestedTree)
                            .addClass('collapse')
                    }
                    return li;
                }
            )
        );
        return tree;
    }

    function init() {
        var tree = createTree(listCategories.data);

        $('#treeCSS').append(tree)
            .on('click', '.item',function(){
                $('.active').not(this).removeClass('active');
                $(this).toggleClass('active');
            })
            .on('click', '.state',function(){
                $(this).parent().toggleClass('collapse expand');
            })

    }
</script>

</head>
<body onload="init()">
<div class="container">
    <div id="treeCSS"></div>
</div>
</body>
</html>