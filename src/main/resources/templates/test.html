<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        .invisible{
            display: none;
        }
    </style>
</head>
<body>

<script type="text/javascript">
    var xmlhttp = getXmlHttp(); // Создаём объект XMLHTTP

    function getXmlHttp() {
        var xmlhttp;
        try {
            xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
        } catch (e) {
            try {
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            } catch (E) {
                xmlhttp = false;
            }
        }
        if (!xmlhttp && typeof XMLHttpRequest!='undefined') {
            xmlhttp = new XMLHttpRequest();
        }
        return xmlhttp;
    }
    function changeCountry(id) {

        xmlhttp.open('POST', '/districts', true); // Открываем асинхронное соединение
        xmlhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); // Отправляем кодировку
        xmlhttp.send("cantryId=" + encodeURIComponent(id)); // Отправляем POST-запрос
        xmlhttp.onreadystatechange = function() { // Ждём ответа от сервера
            if (xmlhttp.readyState == 4) { // Ответ пришёл
                if(xmlhttp.status == 200) { // Сервер вернул код 200 (что хорошо)
                    var districts = JSON.parse(xmlhttp.responseText); // Преобразуем JSON-строку в массив
                    var text = "<option value=''>Выберите округ</option>"; // Начинаем создавать элементы в select
                    for (var i in districts) {
                        /* Перебираем все элемены и создаём набор options */
                        text += "<option value='" + districts[i].id + "'>" + districts[i].name + "</option>";
                    }
                    document.myform.districts.style.visibility = 'visible';
                    document.myform.districts.innerHTML = text; // Устанавливаем options в select
                }
            }
        };
    }

    function changeDistrict(id) {

        xmlhttp.open('POST', '/regions', true); // Открываем асинхронное соединение
        xmlhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); // Отправляем кодировку
        xmlhttp.send("districtId=" + encodeURIComponent(id)); // Отправляем POST-запрос
        xmlhttp.onreadystatechange = function() { // Ждём ответа от сервера
            if (xmlhttp.readyState == 4) { // Ответ пришёл
                if(xmlhttp.status == 200) { // Сервер вернул код 200 (что хорошо)
                    var regions = JSON.parse(xmlhttp.responseText); // Преобразуем JSON-строку в массив
                    var text = "<option value=''>Выберите регион</option>"; // Начинаем создавать элементы в select
                    for (var i in regions) {
                        /* Перебираем все элемены и создаём набор options */
                        text += "<option value='" + regions[i].id + "'>" + regions[i].name + "</option>";
                    }
                    document.myform.regions.style.visibility = 'visible';
                    document.myform.regions.innerHTML = text; // Устанавливаем options в select
                }
            }
        };
    }

    function changeRegion(id) {

        xmlhttp.open('POST', '/cities', true); // Открываем асинхронное соединение
        xmlhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); // Отправляем кодировку
        xmlhttp.send("regionId=" + encodeURIComponent(id)); // Отправляем POST-запрос
        xmlhttp.onreadystatechange = function() { // Ждём ответа от сервера
            if (xmlhttp.readyState == 4) { // Ответ пришёл
                if(xmlhttp.status == 200) { // Сервер вернул код 200 (что хорошо)
                    var cities = JSON.parse(xmlhttp.responseText); // Преобразуем JSON-строку в массив
                    var text = "<option value=''>Выберите город</option>"; // Начинаем создавать элементы в select
                    for (var i in cities) {
                        /* Перебираем все элемены и создаём набор options */
                        text += "<option value='" + cities[i].id + "'>" + cities[i].name + "</option>";
                    }
                    document.myform.cities.style.visibility = 'visible';
                    document.myform.cities.innerHTML = text; // Устанавливаем options в select
                }
            }
        };
    }
</script>
<form name="myform" action="#" method="post">
    <div>
        <select name="countries" onchange="changeCountry(this.value)">
            <option value="">Выберите страну</option>
            <option th:each="cantry : ${cantryList}" th:value="${cantry.id}" th:text="${cantry.name}"></option>

        </select>
    </div>
    <br />
    <div >
        <select name="districts" onchange="changeDistrict(this.value)" style="visibility: hidden">
            <option value="">Выберите округ</option>
        </select>
    </div>
    <br />
    <div >
        <select name="regions" onchange="changeRegions(this.value)" style="visibility: hidden">
            <option value="">Выберите регион</option>
        </select>
    </div>
    <br />
    <!--<div>-->
        <!--<select name="cities">-->
            <!--<option value="">Выберите город</option>-->
        <!--</select>-->
    <!--</div>-->
</form>
</body>
</html>